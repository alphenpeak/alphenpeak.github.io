<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Financial Overview | Alphen Peak</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <link rel="stylesheet" href="../assets/css/styles.css">

  <!-- Chart.js -->
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body>

<header>
  <div class="header-inner">
    <div>
      <h1>Alphen Peak</h1>
      <p>Accounting and financial systems support for growing businesses</p>
    </div>

<nav>
  <a href="../index.html" class="nav-item">Home</a>
  <a href="../services.html" class="nav-item">Services</a>
  <a href="../about.html" class="nav-item">About</a>
  <a href="../contact.html" class="nav-item">Contact</a>
</nav>

  </div>
</header>

<main>

  <h2>Financial Overview</h2>
  <p>
    Example management dashboard showing a simplified financial snapshot
    for a small business.
  </p>

  <!-- Filters -->
  <div style="margin: 1.5rem 0;">
    <label>
      From:
      <select id="fromMonth"></select>
    </label>

    <label style="margin-left: 1rem;">
      To:
      <select id="toMonth"></select>
    </label>
  </div>

  <!-- KPI Cards -->
  <div style="display: flex; gap: 1rem; margin-bottom: 2rem; flex-wrap: wrap;">
    <div class="kpi-card">
      <strong>Total Revenue</strong>
      <div id="totalRevenue">—</div>
    </div>
    <div class="kpi-card">
      <strong>Total Expenses</strong>
      <div id="totalExpenses">—</div>
    </div>
    <div class="kpi-card">
      <strong>Gross Profit</strong>
      <div id="grossProfit">—</div>
    </div>
    <div class="kpi-card">
      <strong>Gross Margin</strong>
      <div id="grossMargin">—</div>
    </div>
  </div>

  <!-- Chart -->
  <canvas id="revenueChart" height="120"></canvas>

</main>

<script>
const data = [
  { month: "2024-01", revenue: 120000, expenses: 80000 },
  { month: "2024-02", revenue: 135000, expenses: 90000 },
  { month: "2024-03", revenue: 150000, expenses: 95000 },
  { month: "2024-04", revenue: 145000, expenses: 92000 },
  { month: "2024-05", revenue: 160000, expenses: 100000 }
];

// Populate dropdowns
const fromSelect = document.getElementById("fromMonth");
const toSelect = document.getElementById("toMonth");

data.forEach(row => {
  const opt1 = document.createElement("option");
  opt1.value = row.month;
  opt1.textContent = row.month;
  fromSelect.appendChild(opt1);

  const opt2 = document.createElement("option");
  opt2.value = row.month;
  opt2.textContent = row.month;
  toSelect.appendChild(opt2);
});

// Default selection
fromSelect.selectedIndex = 0;
toSelect.selectedIndex = data.length - 1;

let chart;

function renderDashboard() {
  const from = fromSelect.value;
  const to = toSelect.value;

  const filtered = data.filter(d => d.month >= from && d.month <= to);

  const totalRevenue = filtered.reduce((sum, d) => sum + d.revenue, 0);
  const totalExpenses = filtered.reduce((sum, d) => sum + d.expenses, 0);
  const grossProfit = totalRevenue - totalExpenses;
  const grossMargin = totalRevenue
    ? ((grossProfit / totalRevenue) * 100).toFixed(1) + "%"
    : "—";

  document.getElementById("totalRevenue").textContent = totalRevenue.toLocaleString();
  document.getElementById("totalExpenses").textContent = totalExpenses.toLocaleString();
  document.getElementById("grossProfit").textContent = grossProfit.toLocaleString();
  document.getElementById("grossMargin").textContent = grossMargin;

  const labels = filtered.map(d => d.month);
  const revenues = filtered.map(d => d.revenue);

  if (chart) chart.destroy();

  chart = new Chart(document.getElementById("revenueChart"), {
    type: "line",
    data: {
      labels,
      datasets: [{
        label: "Revenue",
        data: revenues,
        borderColor: "#1f3a5f",
        backgroundColor: "rgba(31, 58, 95, 0.1)",
        tension: 0.3,
        fill: true
      }]
    },
    options: {
      responsive: true,
      plugins: {
        legend: { display: false }
      }
    }
  });
}

fromSelect.addEventListener("change", renderDashboard);
toSelect.addEventListener("change", renderDashboard);

// Initial render
renderDashboard();
</script>

</body>
</html>
